<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Activities List</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    .activity {
      background-color: #fff;
      padding: 15px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .activity h2 {
      margin: 0;
      font-size: 24px;
      cursor: pointer;
      color: #007BFF;
    }

    .activity h2:hover {
      text-decoration: underline;
    }

    .create-form, .update-form {
      display: none; /* Initially hidden */
      background-color: #f9f9f9;
      padding: 15px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .create-form input[type="text"],
    .create-form input[type="date"],
    .create-form input[type="time"],
    .update-form input[type="text"],
    .update-form input[type="date"],
    .update-form input[type="time"] {
      margin-bottom: 10px;
      padding: 8px;
      width: calc(100% - 20px);
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .create-form button,
    .update-form button,
    .toggle-button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

    .create-form button:hover,
    .update-form button:hover,
    .toggle-button:hover {
      background-color: #0056b3;
    }

    .delete-button {
      background-color: red;
      color: white;
    }

    .delete-button:hover {
      background-color: darkred;
    }

    .update-button {
      background-color: orange;
      color: white;
      margin-left: 10px;
    }

    .update-button:hover {
      background-color: darkorange;
    }

    /* Styles for the Google Maps section */
    #map,
    #updateMap {
      height: 200px; /* Set height for small map */
      width: 100%; /* Set width for map */
      margin: 10px 0;
    }
  </style>
  <script
  async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjbAAKNhaUHHM7DmvEdWNVJqC2iDQtrG4&callback=initMap&libraries=places"
></script></head>
<body>

  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tour Guide Itinerary</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    nav {
      background-color: #333;
      padding: 10px;
      margin-bottom: 20px;
    }

    nav a {
      color: white;
      text-decoration: none;
      padding: 10px;
      margin-right: 10px;
      display: inline-block;
    }

    nav a:hover {
      background-color: #575757;
      border-radius: 4px;
    }

    .itinerary {
      background: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .activity {
      margin: 10px 0;
    }

    .activity h3 {
      margin: 0;
    }

    .delete-button {
      background-color: #ff4d4d;
      color: white;
      border: none;
      padding: 8px;
      cursor: pointer;
      border-radius: 4px;
    }

    .delete-button:hover {
      background-color: #ff1a1a;
    }

    .update-form {
      display: none;
      background: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .update-form input, .update-form select {
      width: 100%;
      margin: 5px 0;
      padding: 8px;
    }

    .update-button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      border-radius: 4px;
    }

    .update-button:hover {
      background-color: #45a049;
    }
    #map {
  height: 200px; /* Set height for small map */
  width: 100%; /* Set width for map */
  margin: 10px 0;
}
  </style>
</head>
<body>

<!-- prettier-ignore -->
<script>(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})
  ({key: "AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg", v: "weekly"});</script>

  

  <nav>
    <a>Advertiser</a>
    <a href="advertiserProfile.html">Profile</a>
    <a href="activities.html">Activities</a>
    <a href="Main.html">Back to Main Page</a>
  </nav>

  <h1>Activities List</h1>

  <div id="activityContainer">
    <!-- Activities will be loaded here -->
  </div>


  <button class="toggle-button" onclick="toggleCreateForm()">Create New Activity</button>
  <button onclick="fetchActivities()">Load Activities</button>

  <div id="createFormContainer" class="create-form">
    <h2>Create New Activity</h2>
    <input type="text" id="activityName" placeholder="Name">
    <input type="date" id="activityName" placeholder="Name">
    <input type="date" id="activityDate" placeholder="Date">
    <input type="time" id="activityTime" placeholder="Time">


    <div id="map" style="height: 200px; width: 100%; margin: 10px 0;"></div>
    <input type="text" id="activityPrice" placeholder="Price"> <!-- Changed to text -->
    <label for="Category">Category:</label>
    <select id="activityCategory" name="Categories" size="1" onclick="toggleDropdown(this)">
      <!-- Category options will be populated here by JavaScript -->
    </select>
    <br>
    <br>
    
    <label for="Tags">Tags:</label>
    <select id="activityTagsDropdown" name="Tags" multiple >
      <!-- Category options will be populated here by JavaScript -->
    </select>
<script>
    document.addEventListener('DOMContentLoaded', function () {
      const selectElement = document.getElementById('activityTagsDropdown');
    
      // Handle mousedown instead of click to prevent default behavior
      selectElement.addEventListener('mousedown', function(event) {
        event.preventDefault(); // Prevent the default behavior
        const option = event.target;
    
        // Toggle selection state manually
        if (option.tagName === 'OPTION') {
          option.selected = !option.selected;
        }
      });
    });

    document.addEventListener('DOMContentLoaded', function () {
      const selectElement = document.getElementById('updateActivityTags');
    
      // Handle mousedown instead of click to prevent default behavior
      selectElement.addEventListener('mousedown', function(event) {
        event.preventDefault(); // Prevent the default behavior
        const option = event.target;
    
        // Toggle selection state manually
        if (option.tagName === 'OPTION') {
          option.selected = !option.selected;
        }
      });
    });
            </script>
        

    
   
    <input type="text" id="activityDiscounts" placeholder="Special Discounts">
    <input type="text" id="activityDuration" placeholder="Duration">
    <select id="bookingOpen">
      <option value="true">Booking Open</option>
      <option value="false">Booking Closed</option>
    </select>
    <br>
    <button onclick="createActivity()">Create Activity</button>
  </div>

  <!-- <script>
    document.addEventListener('DOMContentLoaded', function () {
 const selectElement = document.getElementById('activityTagsDropdown');

 // Handle mousedown instead of click to prevent default behavior
 selectElement.addEventListener('mousedown', function(event) {
   event.preventDefault(); // Prevent the default behavior
   const option = event.target;

   // Toggle selection state manually
   if (option.tagName === 'OPTION') {
     option.selected = !option.selected;
   }
 });
});</script> -->

  <script>
    function toggleDropdown(selectElement) {
      // Check if the dropdown is expanded or not
      if (selectElement.size === 1) {
        // Set size to show all options
        selectElement.size = selectElement.options.length;
      } else {
        // Collapse back to showing only one option
        selectElement.size = 1;
      }
  
      // Close the dropdown when it loses focus
      selectElement.addEventListener('blur', function() {
        selectElement.size = 1;
      });
    }
  </script>

<div id="updateFormContainer" class="update-form">
  <h2>Update Activity</h2>
  
  <label for="UpdateActivityName">Name:</label>
  <input type="text" id="UpdateActivityName" name="UpdateActivityName" placeholder="Enter activity name">
  
  <label for="updateActivityDate">Date:</label>
  <input type="date" id="updateActivityDate" name="updateActivityDate" placeholder="Enter activity date">
  
  <label for="updateActivityTime">Time:</label>
  <input type="time" id="updateActivityTime" name="updateActivityTime" placeholder="Enter activity time">
  
  <div id="updateMap" style="height: 200px; width: 100%; margin: 10px 0;"></div>
  
  <label for="updateActivityPrice">Price:</label>
  <input type="text" id="updateActivityPrice" name="updateActivityPrice" placeholder="Enter price">
  
  <label for="updateActivityCategory">Category:</label>
  <select id="updateActivityCategory" name="updateActivityCategory">
      <option value="">Select Category</option>
  </select>
  
  <label for="updateActivityTagsDropdown">Tags:</label>
  <select id="updateActivityTagsDropdown" name="updateActivityTags" multiple>
      <!-- Tag options will be populated by JavaScript -->
  </select>
  
  <label for="updateActivityDiscounts">Special Discounts:</label>
  <input type="text" id="updateActivityDiscounts" name="updateActivityDiscounts" placeholder="Enter special discounts">
  
  <label for="UpdateActivityDuration">Duration:</label>
  <input type="text" id="UpdateActivityDuration" name="UpdateActivityDuration" placeholder="Enter duration">
  
  <label for="updateBookingOpen">Booking Status:</label>
  <select id="updateBookingOpen" name="updateBookingOpen">
      <option value="true">Booking Open</option>
      <option value="false">Booking Closed</option>
  </select>
  
  <!-- Add the map div here -->
 
  
  <button onclick="updateActivity()">Update Activity</button>
</div>
<script>
  let lats;
  let lngs;
  
  map.addListener("click", (mapsMouseEvent) => {
    lats = mapsMouseEvent.latLng.lat();
    lngs = mapsMouseEvent.latLng.lng();
  
    console.log(`Latitude: ${lat}, Longitude: ${lng}`);
  });

  console.log(lats);
  </script>

  <script>

    

    
    // Function to create a new activity
    async function createActivity() {
  if (lats && lngs) {
    console.log("createActivity function called");

    // Get selected tags as an array of values
    const selectedTags = Array.from(document.getElementById('activityTagsDropdown').selectedOptions)
                              .map(option => option.value);

    const activityData = {
      name: document.getElementById('activityName').value,
      date: document.getElementById('activityDate').value,
      time: document.getElementById('activityTime').value,
      lat: lats,
      lng: lngs,
      price: document.getElementById('activityPrice').value,
      duration: document.getElementById('activityDuration').value,
      category: document.getElementById('activityCategory').value, // Direct ID
      tags: selectedTags, // Array of selected tag IDs
      bookingOpen: document.getElementById('bookingOpen').value === 'true',
    };

    try {
      const response = await fetch('http://localhost:8000/api/activity/createActivity', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(activityData),
      });
      if (response.ok) {
        alert('Activity created successfully!');
        fetchActivities(); // Refresh the activity list
        toggleCreateForm(); // Hide the create form
      } else {
        console.log(lats);
        console.log(activityData);
        alert('Failed to create activity.');
      }
    } catch (error) {
      console.error('Error creating activity:', error);
    }
  } else {
    alert('Please click on the map to select a location.');
  }
}
    // Function to fetch categories and populate the dropdown
async function fetchCategories() {
  try {
    const response = await fetch('http://localhost:8000/api/category/getCategories'); // Ensure the API URL is correct
    if (!response.ok) {
      throw new Error(`Failed to fetch categories: ${response.status}`);
    }

    const categories = await response.json();

    const categoryDropdown = document.getElementById('activityCategory');
    const updateCategoryDropdown = document.getElementById('updateActivityCategory');

    // Clear any existing options
    categoryDropdown.innerHTML = '<option value="">Select Category</option>';
    updateCategoryDropdown.innerHTML = '<option value="">Select Category</option>';

    // Populate the dropdowns with categories
    categories.forEach(category => {
      const option = document.createElement('option');
      option.value = category._id;  // Use the category ID as the value
      option.text = category.name;  // Use the category name as the text
      categoryDropdown.appendChild(option);

      // Also add to the update dropdown
      const updateOption = document.createElement('option');
      updateOption.value = category._id;
      updateOption.text = category.name;
      updateCategoryDropdown.appendChild(updateOption);
    });
  } catch (error) {
    console.error('Error fetching categories:', error);
  }
}
document.addEventListener('DOMContentLoaded', fetchCategories);

async function fetchTags() {
  try {
    const response = await fetch('http://localhost:8000/api/preferenceTag/getpreferenceTags');
    if (!response.ok) {
      throw new Error(`Failed to fetch tags: ${response.status}`);
    }

    const tags = await response.json();

    const tagDropdown = document.getElementById('activityTagsDropdown'); // For create form
    const updateTagDropdown = document.getElementById('updateActivityTagsDropdown'); // For update form

    // Clear existing options
    tagDropdown.innerHTML = '<option value="">Select Tags</option>';
    updateTagDropdown.innerHTML = '<option value="">Select Tags</option>';

    // Populate both dropdowns with tags
    tags.forEach(tag => {
      const option = document.createElement('option');
      option.value = tag._id;
      option.text = tag.name;
      tagDropdown.appendChild(option);

      const updateOption = document.createElement('option');
      updateOption.value = tag._id;
      updateOption.text = tag.name;
      updateTagDropdown.appendChild(updateOption);
    });
  } catch (error) {
    console.error('Error fetching tags:', error);
  }
}

// Call fetchTags on page load
document.addEventListener('DOMContentLoaded', fetchTags);
// Call fetchTags when the page loads
document.addEventListener('DOMContentLoaded', fetchTags);

// Call fetchTags when the page loads
document.addEventListener('DOMContentLoaded', fetchTags);



// Call fetchCategories when the page loads

    let currentActivityId = null; // To hold the current activity ID for updates
    let map; // Map variable for creating Google Map instance
    let geocoder; // Geocoder for converting location to coordinates

    // Initialize the Google Map
    // function initMap() {
    //   geocoder = new google.maps.Geocoder(); // Initialize Geocoder
    //   map = new google.maps.Map(document.getElementById("map"), {
    //     center: { lat: 43.4142989, lng: -124.2301242 }, // Default center (can be adjusted)
    //     zoom: 4,
    //   });
    // }

    async function initMap() {
  // Request needed libraries.
  const { Map } = await google.maps.importLibrary("maps");
  const myLatlng = { lat: -25.363, lng: 131.044 };
  const map = new google.maps.Map(document.getElementById("map"), {
    zoom: 4,
    center: myLatlng,
  });
  // Create the initial InfoWindow.
  let infoWindow = new google.maps.InfoWindow({
    content: "Click the map to get Lat/Lng!",
    position: myLatlng,
  });

  infoWindow.open(map);

  // Configure the click listener.
  map.addListener("click", (mapsMouseEvent) => {
    // Close the current InfoWindow.
    infoWindow.close();
    // Create a new InfoWindow.
    infoWindow = new google.maps.InfoWindow({
      position: mapsMouseEvent.latLng,
    });
    infoWindow.setContent(
      JSON.stringify(mapsMouseEvent.latLng.toJSON(), null, 2),
    );
    infoWindow.open(map);

    // Update the lats and lngs variables
    lats = mapsMouseEvent.latLng.lat();
    lngs = mapsMouseEvent.latLng.lng();

    console.log(`Latitude: ${lats}, Longitude: ${lngs}`);
  });
}

    // Function to get coordinates from the location input
   // Function to get coordinates from the location input
// Function to get coordinates from the location input
// Function to get coordinates from the location input
// Function to get coordinates from the location input
async function getCoordinates(isUpdate = false) {
  const locationInput = isUpdate ? document.getElementById('updateActivityLocation').value : document.getElementById('activityLocation').value;
  geocoder.geocode({ 'address': locationInput }, (results, status) => {
    if (status === 'OK') {
      const location = results[0].geometry.location;
      const mapElement = isUpdate ? document.getElementById('updateMap') : document.getElementById('map');

      // Initialize the map
      const script = document.createElement('script');
      script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&callback=initMap`;
      script.async = true;
      script.defer = true;
      document.head.appendChild(script);

      window.initMap1= async () => {
        const { google } = window;
        const myLatlng = location;
        const map = new google.maps.Map(mapElement, {
          zoom: 15,
          center: myLatlng,
        });

        // Create the initial InfoWindow.
        let infoWindow = new google.maps.InfoWindow({
          content: "Click the map to get Lat/Lng!",
          position: myLatlng,
        });

        infoWindow.open(map);

        // Configure the click listener.
        map.addListener("click", (mapsMouseEvent) => {
          // Close the current InfoWindow.
          infoWindow.close();
          // Create a new InfoWindow.
          infoWindow = new google.maps.InfoWindow({
            position: mapsMouseEvent.latLng,
          });
          infoWindow.setContent(
            JSON.stringify(mapsMouseEvent.latLng.toJSON(), null, 2),
          );
          infoWindow.open(map);

          // Update the activity location
          const lat = mapsMouseEvent.latLng.lat();
          const lng = mapsMouseEvent.latLng.lng();
          if (!isUpdate) {
            document.getElementById('activityLocation').value = `${lat}, ${lng}`;
          } else {
            document.getElementById('updateActivityLocation').value = `${lat}, ${lng}`;
          }
        });
      };
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
}
    // Function to fetch Activities
  // Function to fetch Activities
  // Function to fetch Activities
// Function to fetch Activities
// Function to fetch Activities
async function fetchActivities() {
  console.log("fetchActivities function called");
  try {
    const response = await fetch('http://localhost:8000/api/activity/getActivity'); // Fetch data from the API
    console.log('Response status:', response.status);
    const data = await response.json();
    console.log('Data:', data); // Parse the response to JSON

    const container = document.getElementById('activityContainer');
    container.innerHTML = ''; // Clear any existing data

    if (response.ok && data.length > 0) {
      data.forEach(activity => {
        const activityElement = document.createElement('div');
        activityElement.className = 'activity';

        // Handle tags: If `tags` is not an array, convert it to an array
        let tags = activity.tags;
        if (!Array.isArray(tags)) {
          tags = [tags]; // Convert to array if it's a single object
        }

        // Creating elements dynamically for each activity
        activityElement.innerHTML = `
          <h2>${activity.name}</h2>
          <p>${new Date(activity.date).toLocaleDateString()} ${activity.time}</p>
          <div id="map-${activity._id}" style="height: 200px; width: 100%; margin: 10px 0;"></div> <!-- Map div -->
          <p>Price: ${activity.price}</p>
          <p>Category:${activity.category ? activity.category.name : 'N/A'}</p>
          <p>Tags: ${tags && tags.length > 0 ? tags.map(tag => tag.name).join(', ') : 'None'}</p>
          <p>Special Discounts: ${activity.specialDiscounts}</p>
          <p><strong>Booking Open: ${activity.bookingOpen ? 'Yes' : 'No'}</strong></p>
          <button class="delete-button" onclick="deleteActivity('${activity._id}')">Delete Activity</button>
          <button class="update-button" onclick="showUpdateForm('${activity._id}')">Update Activity</button>
        `;

        container.appendChild(activityElement);

        // Initialize the Google Map
        const mapElement = document.getElementById(`map-${activity._id}`);
        const map = new google.maps.Map(mapElement, {
          center: { lat: activity.lat, lng: activity.lng },
          zoom: 15,
        });
        new google.maps.Marker({
          position: { lat: activity.lat, lng: activity.lng },
          map: map,
        });
      });
    } else {
      container.innerHTML = '<p>No activities found.</p>';
    }
  } catch (error) {
    console.error('Error fetching activities:', error);
  }
}
    // Function to delete an activity
    async function deleteActivity(id) {
      console.log("deleteActivity function called with id:", id);
      try {
        const response = await fetch(`http://localhost:8000/api/activity/deleteActivity`, {
          method: 'DELETE',
          headers: {
        'Content-Type': 'application/json' // Ensure you're sending JSON data
      },
          body: JSON.stringify({ id })
        });
        if (response.ok) {
          alert('Activity deleted successfully!');
          fetchActivities(); // Refresh the activity list
        } else {
          alert('Failed to delete activity.');
        }
      } catch (error) {
        console.error('Error deleting activity:', error);
      }
    }

  // Function to show update form
// Function to show update form
// Function to show update form
// Function to show update form
let updateLat; // To hold the updated latitude
let updateLng; // To hold the updated longitude

async function initUpdateMap(lat, lng) {
    const { Map } = await google.maps.importLibrary("maps");

    const mapElement = document.getElementById("updateMap");
    const myLatlng = { lat: lat, lng: lng }; // Use the provided latitude and longitude

    const map = new Map(mapElement, {
        zoom: 15,
        center: myLatlng,
    });

    const marker = new google.maps.Marker({
        position: myLatlng,
        map: map,
    });

    // Update latitude and longitude when the map is clicked
    map.addListener("click", (mapsMouseEvent) => {
        const latLng = mapsMouseEvent.latLng.toJSON();
        updateLat = latLng.lat; // Update the latitude
        updateLng = latLng.lng; // Update the longitude

        // Move the marker to the new location
        marker.setPosition(latLng);
        
        // Update the location input field
        document.getElementById('updateActivityLocation').value = `${updateLat}, ${updateLng}`;
    });
}

async function showUpdateForm(id) {
    try {
        const response = await fetch(`http://localhost:8000/api/activity/getActivityById?id=${id}`, {
            method: 'GET',
            headers: { 'Content-Type': 'application/json' },
        });
        if (response.ok) {
            const activity = await response.json();
            console.log('Activity retrieved:', activity);
            selectedActivity = activity; // Store the activity ID to update

            // Fill the update form with the activity data
            document.getElementById('UpdateActivityName').value = activity.name;
            document.getElementById('updateActivityDate').value = activity.date.split('T')[0]; // Date format adjustment
            document.getElementById('updateActivityTime').value = activity.time;
            document.getElementById('updateActivityPrice').value = activity.price;
            document.getElementById('updateActivityCategory').value = activity.category._id; // Use the category ID
            document.getElementById('updateActivityDiscounts').value = activity.specialDiscounts;
            document.getElementById('updateBookingOpen').value = activity.bookingOpen ? 'true' : 'false';

            // Populate the tags in the update form by selecting the relevant options
            const tagDropdown = document.getElementById('updateActivityTagsDropdown'); // Correct ID for multi-select
            const selectedTags = activity.tags.map(tag => tag._id); // Get the tag IDs

            // Loop through the options in the dropdown and mark those that match the selected tags
            for (let option of tagDropdown.options) {
                option.selected = selectedTags.includes(option.value); // Mark the matching tags as selected
            }

            // Initialize the map with the activity's latitude and longitude
            initUpdateMap(activity.lat, activity.lng);

            // Store the initial lat and lng
            updateLat = activity.lat;
            updateLng = activity.lng;

            toggleUpdateForm(); // Show update form
        } else {
            console.error('Failed to get activity by ID:', response.status);
            throw new Error('Failed to get activity by ID');
        }
    } catch (error) {
        console.error('Error showing update form:', error);
    }
}
// Function to toggle the update form visibility
function toggleUpdateForm() {
  const updateFormContainer = document.getElementById('updateFormContainer');
  updateFormContainer.style.display = updateFormContainer.style.display === 'none' ? 'block' : 'none';
}
// Function to update an activity
async function updateActivity() {
    console.log("updateActivity function called");
    const id = selectedActivity._id; // Get the ID of the selected activity

    // Create an object to hold updated data, including new lat and lng
    const updatedData = {
        name: document.getElementById('UpdateActivityName').value,
        date: document.getElementById('updateActivityDate').value,
        time: document.getElementById('updateActivityTime').value,
        lat: updateLat, // Use the updated latitude
        lng: updateLng, // Use the updated longitude
        price: document.getElementById('updateActivityPrice').value,
        category: document.getElementById('updateActivityCategory').value, // Use the category ID
        tags: Array.from(document.getElementById('updateActivityTagsDropdown').selectedOptions) // Get selected options
            .map(option => option.value), // Get the values (IDs) of the selected tags
        specialDiscounts: document.getElementById('updateActivityDiscounts').value,
        bookingOpen: document.getElementById('updateBookingOpen').value === 'true',
    };

    try {
        const response = await fetch(`http://localhost:8000/api/activity/updateActivity`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ id, ...updatedData }), // Send the ID with the updated data
        });
        if (response.ok) {
            alert('Activity updated successfully!');
            fetchActivities(); // Refresh the activity list
            toggleUpdateForm(); // Hide the update form
        } else {
            alert('Failed to update activity.');
        }
    } catch (error) {
        console.error('Error updating activity:', error); 
    }
}
// Function to get an activity by ID
// Function to get an activity by ID
// Function to get an activity by ID
async function getActivityById(id) {
  try {
    const response = await fetch(`http://localhost:8000/api/activity/getActivityById`, {
      method: 'GET',
      headers: { 'Content-Type': 'application/json' },
 
    });
    if (response.ok) {
      return await response.json();
    } else {
      throw new Error('Failed to get activity by ID');
    }
  } catch (error) {
    console.error('Error getting activity by ID:', error);
  }
}
  </script>
</body>
</html>
